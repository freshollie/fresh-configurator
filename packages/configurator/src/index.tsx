import React from "react";
import ReactDOM from "react-dom";
import { ApolloProvider } from "@apollo/client";
import { ErrorBoundary, FallbackProps } from "react-error-boundary";
import { Box, Provider as BumbagProvider, ThemeConfig } from "bumbag";
import App from "./App";
import client from "./gql/client";

const Fallback: React.FC<FallbackProps> = ({ error, resetErrorBoundary }) => (
  <div
    role="alert"
    style={{
      display: "flex",
      alignItems: "center",
      justifyContent: "center",
      flexDirection: "column",
    }}
  >
    <h1>Something went wrong :(</h1>
    <pre>{error.stack}</pre>
    <button
      type="button"
      onClick={async () => {
        await client.resetStore();
        resetErrorBoundary();
      }}
    >
      Reload
    </button>
  </div>
);

const theme: ThemeConfig = {
  Icon: {
    icons: {
      receiver: {
        viewBoxWidth: 141.7,
        viewBoxHeight: 141.7,
        paths: [
          `M111.4,49.1H98.6c-2.7-4-7.3-6.6-12.4-6.6H75.3V6c0-2.4-2-4.4-4.4-4.4s-4.4,2-4.4,4.4v36.5H56.5
        c-5.1,0-9.7,2.6-12.4,6.6H30.5c-8.2,0-15,6.7-15,15v61.1c0,8.2,6.7,15,15,15h80.9c8.2,0,15-6.7,15-15V64.1
        C126.4,55.8,119.6,49.1,111.4,49.1z M45.9,106.5c-9.6,0-17.4-7.8-17.4-17.4c0-9.6,7.8-17.4,17.4-17.4c9.6,0,17.4,7.8,17.4,17.4
        C63.3,98.7,55.5,106.5,45.9,106.5z M95.3,106.5c-9.6,0-17.4-7.8-17.4-17.4c0-9.6,7.8-17.4,17.4-17.4s17.4,7.8,17.4,17.4
        C112.7,98.7,104.9,106.5,95.3,106.5z`,
        ],
      },
      "acc-sensor": {
        viewBoxWidth: 30,
        viewBoxHeight: 25,
        paths: [
          `M 17.035156 3.582031 L 19.074219 7.164062 L 10.917969 7.164062 L 14.996094 0 Z M 17.035156 3.582031`,
          `M 26.785156 21.160156 L 28.824219 24.742188 L 20.667969 24.742188 L 24.746094 17.578125 Z M 26.785156 21.160156 `,
          `M 7.164062 21.160156 L 9.203125 24.742188 L 1.046875 24.742188 L 5.125 17.578125 Z M 7.164062 21.160156 `,
          `M 6.292969 20.039062 L 14.859375 15.09375 L 16.144531 17.324219 L 7.582031 22.269531 Z M 6.292969 20.039062 `,
          `M 16.28125 6.867188 L 16.285156 16.757812 L 13.710938 16.757812 L 13.707031 6.867188 Z M 16.28125 6.867188 `,
          `M 14.996094 15.09375 L 23.558594 20.039062 L 22.273438 22.269531 L 13.707031 17.324219 Z M 14.996094 15.09375 `,
        ],
      },
      "baro-sensor": {
        viewBoxHeight: 30,
        viewBoxWidth: 30,
        paths: [
          `M 13.648438 0.488281 C 13.308594 0.519531 13.101562 0.582031 12.90625 0.699219 C 12.753906 
          0.785156 12.484375 0.898438 12.300781 0.957031 C 12.105469 1.015625 11.867188 1.144531 11.71875
           1.28125 C 11.582031 1.402344 11.34375 1.609375 11.191406 1.746094 C 11.039062 1.878906 10.84375 
           2.101562 10.757812 2.234375 C 10.664062 2.371094 10.535156 2.554688 10.464844 2.640625 C 10.390625 
           2.738281 10.253906 3.109375 10.144531 3.558594 L 9.957031 4.316406 L 9.9375 9.246094 C 9.929688 
           11.957031 9.914062 14.472656 9.898438 14.847656 C 9.875 15.667969 9.769531 15.960938 9.441406 
           16.152344 C 9.320312 16.21875 9.050781 16.449219 8.847656 16.652344 C 8.644531 16.859375 8.398438 
           17.105469 8.300781 17.191406 C 8.210938 17.285156 8.082031 17.457031 8.015625 17.578125 C 7.953125 
           17.699219 7.859375 17.816406 7.804688 17.839844 C 7.75 17.859375 7.652344 18.007812 7.578125 18.164062
           C 7.511719 18.332031 7.367188 18.613281 7.253906 18.796875 C 7.144531 18.980469 7.015625 19.285156 6.980469 19.46875 
           C 6.9375 19.652344 6.8125 20.015625 6.710938 20.265625 L 6.519531 20.722656 L 6.519531 23.355469 L 6.710938 23.816406 
           C 6.8125 24.066406 6.949219 24.464844 7.003906 24.703125 C 7.066406 24.9375 7.179688 25.222656 7.261719 25.335938 C 7.347656 25.445312 
           7.476562 25.664062 7.542969 25.824219 C 7.609375 25.984375 7.777344 26.234375 7.902344 26.386719 C 8.394531 26.957031 8.609375 
           27.195312 8.738281 27.324219 C 9.292969 27.863281 9.429688 27.980469 9.484375 27.980469 C 9.519531 27.980469 9.65625 
           28.070312 9.785156 28.1875 C 9.914062 28.304688 10.167969 28.457031 10.351562 28.53125 
           C 10.53125 28.605469 10.738281 28.714844 10.804688 28.777344 C 10.960938 28.921875 
           11.1875 29.007812 11.707031 29.117188 C 11.9375 29.160156 12.234375 29.257812 
           12.367188 29.328125 C 12.730469 29.511719 13.46875 29.589844 14.589844 29.558594 
           C 15.515625 29.535156 15.617188 29.515625 16.070312 29.34375 C 16.339844 29.242188 
           16.777344 29.113281 17.039062 29.058594 C 17.332031 28.988281 17.578125 28.890625 17.6875 28.804688 
           C 17.785156 28.71875 17.992188 28.597656 18.160156 28.53125 C 18.324219 28.457031 18.527344 28.335938 
           18.613281 28.261719 C 18.699219 28.179688 18.875 28.046875 19.011719 27.960938 C 19.285156 27.796875 
           20.449219 26.664062 20.449219 26.570312 C 20.449219 26.535156 20.539062 26.40625 20.652344 26.285156
            C 20.765625 26.15625 20.902344 25.929688 20.964844 25.78125 C 21.019531 25.628906 21.132812 25.425781 
            21.21875 25.335938 C 21.300781 25.238281 21.410156 24.996094 21.460938 24.808594 C 21.558594 24.453125 
            21.644531 24.195312 21.871094 23.539062 C 21.980469 23.230469 21.996094 23.019531 22.003906 22.101562 
            C 22.011719 20.988281 21.957031 20.582031 21.730469 20.128906 C 21.660156 20.003906 21.574219 19.71875
             21.527344 19.492188 C 21.472656 19.242188 21.367188 18.992188 21.25 18.828125 C 21.148438 18.679688 
             21.019531 18.441406 20.96875 18.300781 C 20.921875 18.160156 20.78125 17.9375 20.664062 17.808594 C 
             20.546875 17.675781 20.449219 17.546875 20.449219 17.515625 C 20.449219 17.425781 19.21875 16.222656 
             19.027344 16.125 C 18.9375 16.078125 18.828125 15.980469 18.789062 15.90625 C 18.558594 15.476562 
             18.550781 15.292969 18.550781 9.828125 L 18.550781 4.5 L 18.402344 3.886719 C 18.324219 3.550781 
             18.238281 3.171875 18.21875 3.042969 C 18.195312 2.921875 18.097656 2.722656 18.007812 2.613281 
             C 17.90625 2.511719 17.792969 2.332031 17.738281 2.234375 C 17.554688 1.875 16.652344 1.113281 
             16.238281 0.972656 C 16.078125 0.917969 15.800781 0.800781 15.617188 0.710938 C 15.390625 0.59375 
             15.132812 0.527344 14.761719 0.484375 C 14.472656 0.453125 14.210938 0.433594 14.171875 0.441406 C 
             14.144531 0.441406 13.902344 0.464844 13.648438 0.488281 Z M 14.570312 2.136719 C 15.019531 2.253906
              15.703125 2.582031 15.941406 2.796875 C 16.082031 2.921875 16.285156 3.148438 16.390625 3.300781 C 
              16.8125 3.894531 16.78125 3.34375 16.792969 10.316406 L 16.804688 16.640625 L 16.960938 16.8125 C 
              17.042969 16.898438 17.234375 17.03125 17.386719 17.101562 C 17.539062 17.167969 17.785156 17.332031 
              17.9375 17.460938 C 18.359375 17.835938 18.980469 18.453125 18.980469 18.503906 C 18.980469 18.53125 
              19.070312 18.65625 19.1875 18.785156 C 19.304688 18.914062 19.445312 19.140625 19.507812 19.285156 C 
              19.566406 19.4375 19.691406 19.683594 19.78125 19.835938 C 20.015625 20.210938 20.230469 21.488281 
              20.1875 22.195312 C 20.136719 22.996094 19.964844 23.949219 19.832031 24.152344 C 19.769531 24.25 
              19.628906 24.515625 19.523438 24.734375 C 19.304688 25.195312 19.121094 25.433594 18.507812 26.039062 
              C 17.902344 26.652344 17.6875 26.808594 17.015625 27.164062 C 16.480469 27.445312 16.324219 27.496094
               15.445312 27.667969 C 14.332031 27.882812 14.101562 27.894531 13.5 27.757812 C 13.265625 27.710938 
               12.839844 27.625 12.558594 27.582031 C 12.203125 27.519531 11.964844 27.441406 11.792969 27.324219 
               C 11.652344 27.234375 11.398438 27.097656 11.222656 27.023438 C 10.792969 26.847656 9.886719 26.070312 
               9.550781 25.585938 C 9.472656 25.46875 9.355469 25.347656 9.300781 25.304688 C 9.246094 25.261719 9.140625 
               25.082031 9.0625 24.90625 C 8.988281 24.730469 8.839844 24.464844 8.742188 24.320312 C 8.601562 24.117188 
               8.539062 23.914062 8.449219 23.371094 C 8.277344 22.316406 8.253906 22.046875 8.320312 21.582031 C 8.351562 21.34375 
               8.414062 20.933594 8.449219 20.664062 C 8.484375 20.394531 8.570312 20.074219 8.640625 19.960938 C 8.707031 19.84375 
               8.839844 19.566406 8.945312 19.351562 C 9.160156 18.898438 9.402344 18.585938 10.011719 17.992188 C 10.71875 17.289062 
               10.757812 17.265625 11.0625 17.113281 C 11.222656 17.039062 11.425781 16.898438 11.511719 16.804688 L 11.664062 16.640625
                L 11.695312 10.265625 C 11.722656 4.023438 11.722656 3.882812 11.847656 3.699219 C 12.367188 2.890625 12.6875 2.582031 
                13.199219 2.398438 C 13.394531 2.332031 13.671875 2.230469 13.804688 2.179688 C 14.085938 2.070312 14.269531 2.0625 14.570312 
                2.136719 Z M 14.570312 2.136719`,
          `M 13.761719 9.191406 C 13.445312 9.3125 13.445312 9.332031 13.40625 13.585938 L 13.378906 17.535156 L 12.949219
           17.867188 C 12.714844 18.050781 12.402344 18.25 12.257812 18.3125 C 11.851562 18.488281 10.960938 19.242188 
           10.804688 19.535156 C 10.757812 19.621094 10.628906 19.804688 10.511719 19.945312 C 10.378906 20.105469
            10.28125 20.300781 10.253906 20.460938 C 10.230469 20.601562 10.15625 20.859375 10.101562 21.035156 C 9.863281
             21.730469 9.886719 22.285156 10.207031 23.40625 C 10.292969 23.71875 10.425781 24.035156 10.5 24.121094 C 10.574219 
             24.207031 10.691406 24.355469 10.75 24.460938 C 10.859375 24.648438 11.398438 25.179688 11.785156 25.492188 C 12 
             25.664062 12.996094 26.03125 13.714844 26.203125 C 14.160156 26.3125 14.894531 26.253906 15.277344 26.082031 C 15.445312
              26.003906 15.765625 25.890625 15.996094 25.832031 C 16.265625 25.761719 16.492188 25.652344 16.660156 25.519531 
              C 17.222656 25.046875 17.597656 24.691406 17.738281 24.488281 C 17.816406 24.375 17.945312 24.191406 18.023438 
              24.078125 C 18.203125 23.835938 18.550781 22.46875 18.550781 22.011719 C 18.550781 21.820312 18.464844 21.324219
               18.359375 20.90625 C 18.132812 20.015625 18.050781 19.878906 17.148438 18.996094 C 16.75 18.613281 16.488281 
               18.402344 16.316406 18.34375 C 16.082031 18.269531 15.871094 18.128906 15.261719 17.65625 L 15.0625 17.503906 
               L 15.0625 13.664062 C 15.0625 11.554688 15.03125 9.714844 15 9.585938 C 14.921875 9.234375 14.816406 9.160156 
               14.339844 9.140625 C 14.113281 9.132812 13.855469 9.152344 13.761719 9.191406 Z M 13.761719 9.191406`,
        ],
      },
      "gyro-sensor": {
        viewBoxHeight: 30,
        viewBoxWidth: 30,
        paths: [
          `M 20.023438 9.753906 C 27.703125 17.40625 31.648438 25.90625 28.828125 28.726562 C 26.007812 31.546875 17.484375 27.625 9.804688 19.972656 C 2.125 12.320312 -1.820312 3.820312 0.996094 1 C 3.816406 -1.820312 12.339844 2.105469 20.023438 9.753906 Z M 20.023438 9.753906`,
          `M 19.972656 20.023438 C 12.320312 27.703125 3.820312 31.648438 1 28.828125 C -1.820312 26.007812 2.105469 17.484375 9.753906 9.804688 C 17.40625 2.125 25.90625 -1.824219 28.726562 0.996094 C 31.546875 3.816406 27.625 12.34375 19.972656 20.023438 Z M 19.972656 20.023438`,
          `M 390.319539 136.711706 C 478.975983 225.052486 524.521766 323.178846 491.963295 355.737316 C 459.404825 388.295786 361.007896 343.020573 272.351452 254.679792 C 183.695008 166.339012 138.149225 68.212653 170.662601 35.654182 C 203.221071 3.095712 301.618 48.41602 390.319539 136.711706 Z M 390.319539 136.711706`,
          `M 17.664062 15.019531 C 17.664062 16.453125 16.5 17.617188 15.0625 17.617188 C 13.628906 17.617188 12.464844 16.453125 12.464844 15.019531 C 12.464844 13.585938 13.628906 12.421875 15.0625 12.421875 C 16.5 12.421875 17.664062 13.585938 17.664062 15.019531 Z M 17.664062 15.019531`,
          `M 389.733306 255.266025 C 301.392525 343.92247 203.266166 389.468252 170.707696 356.909782 C 138.149225 324.351311 183.469534 225.954383 271.765219 137.297939 C 360.106 48.641494 458.232359 3.050617 490.79083 35.609087 C 523.3493 68.167558 478.074086 166.609581 389.733306 255.266025 Z M 389.733306 255.266025`,
        ],
      },
      "blackbox-log": {
        viewBoxWidth: 141.7,
        viewBoxHeight: 141.7,
        paths: [
          `M123.5,25.8h-6c-2.9,0-6.4,2.2-7.8,4.7L101.4,45c-1.7,3-4.9,4.4-8.3,4.4H46.2c-3.5,0-6.6-1.3-8.3-4.3
          l-8.3-14.9c-1.4-2.5-4.9-4.4-7.8-4.4h-6c-7,0-12.2,5.9-12.2,12.9v63.4c0,7,5.2,12.9,12.2,12.9h107.8c7,0,13.9-5.9,13.9-12.9V38.8
          C137.4,31.8,130.5,25.8,123.5,25.8z M38,85.5c-5.2,0-9.5-4.3-9.5-9.5c0-5.2,4.3-9.5,9.5-9.5s9.5,4.3,9.5,9.5S43.3,85.5,38,85.5z
           M84.4,80.1c0,2.6-2.1,4.6-4.6,4.6H58.8c-2.5,0-4.6-2.1-4.6-4.6v-8.8c0-2.6,2.1-4.6,4.6-4.6h20.9c2.6,0,4.6,2.1,4.6,4.6V80.1z
           M100.6,85.5c-5.2,0-9.5-4.3-9.5-9.5c0-5.2,4.3-9.5,9.5-9.5c5.2,0,9.5,4.3,9.5,9.5S105.9,85.5,100.6,85.5z`,
          `M43.6,36.7c1.4,2.5,4.9,4.9,7.8,4.9h36.4c2.9,0,6.4-2.3,7.8-4.8l3.2-6.1c1.4-2.5,0.2-4.8-2.7-4.8h-53
          c-2.9,0-4.1,2.2-2.7,4.7L43.6,36.7z`,
        ],
      },
    },
  },
};

ReactDOM.render(
  <React.StrictMode>
    <ErrorBoundary FallbackComponent={Fallback}>
      <ApolloProvider client={client}>
        <BumbagProvider theme={theme} colorMode="light">
          <Box minWidth="100vw" minHeight="100vh">
            <App />
          </Box>
        </BumbagProvider>
      </ApolloProvider>
    </ErrorBoundary>
  </React.StrictMode>,
  document.getElementById("app")
);
